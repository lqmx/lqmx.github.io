# 策略模式

###### 2018.01.26

> 策略模式是对象的行为模式，用意是对一组算法的封装。动态的选择需要的算法并使用。

## 策略模式中的角色

+ 抽象策略模式 Strategy
+ 具体策略模式 ConcreteStrategy
+ 环境角色 Context

## 使用场景

+ 许多相关的类仅仅是行为有异。“策略”提供了一种用多个行为中的一个行为来配置一个类的方法
+ 需要使用一个算法的不同变体
+ 算法使用客户不应该知道的数据。可使用策略模式以避免暴露复杂的，与算法相关的数据结构
+ 一个类定义了多种行为，并且 这些行为在这个类的操作中以多个形式出现。将相关的条件分支移和它们各自的Strategy类中以代替这些条件语句

## 实例

```php
<?php

interface Strategy {
    public function algorithmInterface();
}

class ConcreteStrategyA implements Strategy {
    public function algorithmInterface() {
        echo 'A', PHP_EOL;
    }
}

class ConcreteStrategyB implements Strategy {
    public function algorithmInterface() {
        echo 'B', PHP_EOL;
    }
}

class Context {
    private $_strategy;
    public function __construct(Strategy $strategy) {
        $this->_strategy = $strategy;
    }
    public function contextInterface() {
        $this->_strategy->algorithmInterface();
    }
}

$contextA = new Context(new ConcreteStrategyA());
$contextA->contextInterface();

$contextB = new Context(new ConcreteStrategyB());
$contextB->contextInterface();
```

## 优点和缺点

### 优点

+ 策略模式提供了管理相关的算法族的办法
+ 策略模式提供了可以替换继承关系的办法 将算封闭在独立的Strategy类中使得你可以独立于其Context改变它
+ 使用策略模式可以避免使用多重条件转移语句

### 缺点

+ 客户必须了解所有的策略 这是策略模式一个潜在的缺点
+ Strategy和Context之间的通信开销
+ 策略模式会造成很多的策略类

## 参考

[学习php设计模式 php实现策略模式(strategy)](http://www.jb51.net/article/76001.htm)

###### 2018.01.26