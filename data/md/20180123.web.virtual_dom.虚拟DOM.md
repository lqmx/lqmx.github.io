# 虚拟DOM

###### 2018-01-23

## 什么是虚拟DOM

轻量级的JavaScript对象

(1) 提供一种方便的工具，使得开发效率得到保证

(2) 保证最小化的DOM操作，使得执行效率得到保证

Virtual DOM 本质上就是在JS和DOM之间做了一个缓存

### 用JS表示DOM结构

### 比较两棵虚拟DOM树的差异

#### 如何比较两个两棵DOM树

对同级别节点进行比较的常用方法是深度优先遍历
    
#### 如何记录节点之间的差异

+ 修改节点属性, 用PROPS表示
+ 修改节点文本内容, 用TEXT表示
+ 替换原有节点, 用REPLACE表示
+ 调整子节点，包括移动、删除等，用REORDER表示
    
#### 对真实DOM进行最小化修改    

## 虚拟DOM VS 直接操作原生DOM

innerHTML: render html string + 重新创建所有 DOM 元素

Virtual DOM: render Virtual DOM + diff + 必要的 DOM 更新

## 虚拟DOM VS MVVM

脏检查：scope digest + 必要 DOM 更新

依赖收集：重新收集依赖 + 必要 DOM 更新

初始渲染：Virtual DOM > 脏检查 >= 依赖收集

小量数据更新：依赖收集 >> Virtual DOM + 优化 > 脏检查（无法优化） > Virtual DOM 无优化

大量数据更新：脏检查 + 优化 >= 依赖收集 + 优化 > Virtual DOM（无法/无需优化）>> MVVM 无优化

## 参考

[如何理解虚拟DOM?](https://www.zhihu.com/question/29504639)

[React虚拟DOM浅析](http://www.alloyteam.com/2015/10/react-virtual-analysis-of-the-dom/)

###### 2018-01-23