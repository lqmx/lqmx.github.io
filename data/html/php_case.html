<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="update_time" content="1522157513">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PHP中一些奇怪的现象和技巧</title>
    <link rel="shortcut icon" type="images/x-icon" href="/favicon.png?v1522157513">
    <link rel="stylesheet" href="../../css/reset.css?v1522157513">
    <link rel="stylesheet" href="../../css/md.css?v1522157513">
    <link rel="stylesheet" href="../../css/module.css?v1522157513">
    <link rel="stylesheet" href="../../css/c.css?v1522157513">
    <link rel="stylesheet" href="../../dep/highlight/style/monokai_sublime.css?v1522157513">
    <script src="../../dep/require.js?1522157513"></script>
</head>
<body>
    <div class="md"><h1>PHP中一些奇怪的现象和技巧</h1>
<h6>2018.03.25</h6>
<h2>为什么in_array(0, ['a', 'b', 'c'])返回true</h2>
<p>在PHP中，数据会自动转换类型后再进行比较。</p>
<p>这样可能会导致一些费解的现象：</p>
<pre><code class="language-php" data-comment="">in_array(0, ['a', 'b', 'c'])      // 返回bool(true)，也就相当于数组中有0
array_search(0, ['a', 'b', 'c'])  // 返回int(0)，也就是第一个值的下标
0 == 'abc'                        // 返回bool(true)，也就相当于相等</code></pre>
<p>这两个表达式都返回true。</p>
<p>直观上看，0没有在数组<code class="inline-code">['a', 'b', 'c']</code>中，也不会等于abc这个字符串。</p>
<p>那怎么会返回true呢？</p>
<h3>类型转换</h3>
<p>原因就在于，在比较前，PHP做了类型转换。</p>
<p>PHP官网上的说明：<a href="http://php.net/manual/en/language.types.string.php#language.types.string.conversion">http://php.net/manual/en/language.types.string.php#language.types.string.conversion</a></p>
<p>string类型的数据会转换成int型，然后再比较。</p>
<p>而如果string类型数据第一个字符不是数字，就会转换成0。例如，</p>
<pre><code class="language-php" data-comment="">echo intval("Bye");    // 输出0
in_array()和array_search()默认都是松散比较，相当于==，所以就得到true。</code></pre>
<h3>严格比较</h3>
<p>那如何得到false呢？</p>
<p>用严格比较，如下，</p>
<pre><code class="language-php" data-comment="">in_array(0, ['a', 'b', 'c'], true)        // 返回false
array_search(0, ['a', 'b', 'c'], true)    // 返回false
0 === 'abc'                               // 返回false</code></pre>
<p>强制做类型比较，这样就能拿到精确的结果。</p>
<h4>false和null</h4>
<p>那么，如果用false和null与字符串数组比较会如何呢？</p>
<p>它们是不会转换成int型的，所以结果是这样的：</p>
<pre><code class="language-php" data-comment="">in_array(null, ['a', 'b', 'c'])  //返回false
in_array(false, ['a', 'b', 'c']) //返回false</code></pre>
<h3>数组中有true</h3>
<p>另外一个看起来比较奇怪的现象：</p>
<pre><code class="language-php" data-comment="">in_array('a', [true, 'b', 'c'])       // 返回bool(true)，相当于数组里面有字符'a'
array_search('a', [true, 'b', 'c'])   // 返回int(0)，相当于找到了字符'a'</code></pre>
<p>这是为什么呢？</p>
<p>说起来也很好理解，松散比较下，任何string都等于true。</p>
<p>要想不相等，老办法，用严格比较。</p>
<h2>参考</h2>
<ul>
<li><a href="https://www.awaimai.com">歪麦博客</a></li>
</ul>
<h6>2018.03.27</h6></div>
<script >
    requirejs(['../../js/conf/r'], function(rc) {
        requirejs(['../js/html']);
    });
</script>
</body>
</html>